{% extends "base.html" %}
{% load humanize %}
{% load comments %}
{% load mathfilters %}
{% load urlize_target_blank %}
{% load emoticons_tags %}
{% block content %}
<div class="margin">
	{% if notification %}
			<span>
			<div style="background-color:lightyellow;border:solid;border-width:1px;border-color:green;">
				{% if parent_link.submitter.userprofile.avatar %}
					<img src="{{ parent_link.submitter.userprofile.avatar.url }}" alt="no pic" height="22" width="22" style="color:dimgrey;"></img>
				{% else %}
					<img src="{{ STATIC_URL }}img/default-avatar.jpg" alt="no pic" height="22" width="22"></img>
				{% endif %}
				<span style="color:dimgrey;">{{ parent_link.submitter.username }}</span>:<span style="color:dimgrey;"> {{ parent_link.description|truncatechars:40 }}</span>
			
			<p style="margin-top:.5em;"></p>
			<span style="color:darkorange;font-size:90%;">
			<b> is par <a href="{% url 'profile' slug=latest_reply.submitted_by.username %}#section0" style="font-size:90%;">{{ latest_reply.submitted_by.username }}</a> ka neya jawab:</b>
			</span>
				
			<p style="margin-top:.5em;"></p>
			
				{% if latest_reply.submitted_by.userprofile.avatar %}
					<a href="{% url 'profile' slug=latest_reply.submitted_by.username %}#section0">
					<img src="{{ latest_reply.submitted_by.userprofile.avatar.url }}" alt="no pic" height="22" width="22"></img>
					</a>
				{% else %}
					<a href="{% url 'profile' slug=latest_reply.submitted_by.username %}#section0">
					<img src="{{ STATIC_URL }}img/default-avatar.jpg" alt="no pic" height="22" width="22"></img>
					</a>
				{% endif %}
			<a href="{% url 'profile' slug=latest_reply.submitted_by.username %}#section0" style="font-size:110%;">{{ latest_reply.submitted_by.username }}</a>:<span style="font-size:110%;"> {{ latest_reply.description|truncatechars:40 }}</span><span style="font-size:80%;font-family:'arial';color:gray;"><bdi>, {{ latest_reply.submitted_on|naturaltime }}</bdi></span>
				<p style="margin-top:.5em;"></p>
				<a href="{% url 'reply' pk=parent_link_pk %}"><button style="color:#1947d1;background-color:moccasin;border-color:orange;color:#1947D1;width:7em;white-space:nowrap;">jawab do</button></a><a href="{% url 'notif_help' pk=parent_link_pk %}" style="font-size:80%;">  (?)</a>
			</div>
			<p style="margin-top:.5em;"></p>
			<hr size=1>
			<p style="margin-top:-0.9em;"></p>
			<hr size=1>

			<span style="color:darkorange;font-size:90%;"><b>baaqi logoon ki chat:</b></span>
			</span>
	{% else %}
			{% if user.is_authenticated %}
				{% if random == 1 %}
					<span style="color:purple;font-size:90%;"><b>Taza tareen: </b>dekho iss waqt <b><a href="{% url 'online_kon' %}#section0"><u>online kon</u></a></b> hai!</span>
				{% elif random == 2 %}
					<span style="color:purple;font-size:90%;"><b>Taza tareen: </b>sab se <b><a href="{% url 'top' %}"><u>mashoor damadamers</u></a></b> ko dekho!</span>
				{% else %}
					<span style="color:purple;font-size:90%;"><b>Taza tareen: </b><b><a href="{% url 'profile' slug=newest_user.username %}#section0"><u>{{ newest_user.username }}</u></a></b> ne abhi abhi khaata khola. Isko welcome kaho!</span>
				{% endif %}
			{% else %}
				<span style="color:purple;"><a href="{% url 'register_login' %}#section0"><u>Khata khol</u></a> kar neechay chat karo:</span>
			{% endif %}
	{% endif %}
		<p style="margin-top:.5em;">
		{% if is_paginated %}
		<span start="{{ page_obj.start_index }}">
		{% else %}
		<span>
		{% endif %}
		</p>

{% for link in object_list %}
	    {% if link.image_file %}
	    <img src="{{ link.image_file.url }}"></img><br>
		{% endif %}
		{% if link.submitter.userprofile.avatar %}
		<a href="{% url 'profile' slug=link.submitter %}#section0">
		<img src="{{ link.submitter.userprofile.avatar.url }}" alt="no pic" height="22" width="22"></img>
		</a>
		{% else %}
		<a href="{% url 'profile' slug=link.submitter %}#section0">
		<img src="{{ STATIC_URL }}img/default-avatar.jpg" alt="no pic" height="22" width="22"></img>
		</a>
		{% endif %}
			<a href="{% url 'profile' slug=link.submitter %}" class="bigger" style="font-family:arial;line-height:1.8; display:inline;text-shadow:0 0 0px #8080FF;">{{ link.submitter }}</a>
		<span style="font-size:85%;">
		{% if user.is_authenticated %}
				{% if user.usersettings.score_setting == '1' %}
					{% if link.submitter.userprofile.score %}
						{% if link.submitter.userprofile.score < 0 %}
					    	<span style="color:red;">({{ link.submitter.userprofile.score }})</span>
					    {% else %}
					    	<span style="color:#18A018;">({{ link.submitter.userprofile.score }})</span>
						{% endif %}
				    {% else %}
				    {% endif %}
				{% else %}
				{% endif %}
		{% endif %}
		</span>
		    {% for person in checked %}
		    {% if person == link.submitter.username %}
		    	<span style="font-size:150%;color:deeppink;"><b>*</b></span>
		    {% endif %}
		    {% endfor %}:
		{% emoticons %}
    	<span style="color:black; font-size:125%; font-family:arial; line-height:1.8;text-shadow:0 0 0px #808080;">{{ link.description|urlize_target_blank:25 }}</span>
    	{% endemoticons %}
			<a name="section{{ forloop.counter }}"></a> 
		<span style="font-size:80%;font-family:'arial';color:gray;"><bdi>, {{ link.submitted_on|naturaltime }}</bdi></span>
		<p>
			{% if link.publicreply_set.count %}
				{% if link.publicreply_set.count < 26 %}
						<a href="{% url 'reply' pk=link.pk %}"><button style="background-color:white;border-color:orange;color:#1947D1;width:7em;white-space:nowrap;">{{ link.publicreply_set.count }} jawab</button></a>
				{% else %}
						<a href="{% url 'reply' pk=link.pk %}"><button style="background-color:white;border-color:orange;color:#1947D1;width:7em;white-space:nowrap;">25+ jawab</button></a>
				{% endif %}
			{% else %}
					<a href="{% url 'reply' pk=link.pk %}"><button style="background-color:white;border-color:orange;color:#1947D1;width:7em;white-space:nowrap;">isko jawab do</button></a>
			{% endif %}
		<form  method="POST" action="{% url 'vote' %}" class="vote_form">
		{% csrf_token %}
		<input type="hidden" id="id_link" name="link" class="hidden_id" value="{{ link.pk }}">
		<input type="hidden" id="id_voter" name="voter" class="hidden_id" value="{{ user.pk }}">
		<input type="hidden" id="id_value" name="value" class="hidden_id" value="1">	
		<input type="hidden" id="id_page" name="section_number" value="{{ forloop.counter }}">	
		
		{% if link.pk not in voted and link.submitter != user and can_vote %}	

		<input class="voting" type="submit" id="id_valup" name="val" style="color:white;background-color:#2FC12F;border:none;text-shadow:0 0 0px white;font-size:100%;margin-bottom:0.2em;" value="jhappee">
		{% if user.username in checked %}
		<a href="{% url 'home' %}" style="font-size:90%;color:green;"><u>+50</u></a>
		{% endif %}
		<br>
		<input class="voting" type="submit" id="id_valdown" name="val" style="color:white;background-color:#FF0000;border:none;text-shadow:0 0 0px white;font-size:100%;" value="chupair">
		{% if user.username in checked %}
		<a href="{% url 'home' %}" style="font-size:90%;color:red;"><u>-300</u></a>	
		{% endif %}
		{% endif %}
		</p>
		</form>
		{% if user.is_authenticated %}
		<p style="margin-top:.5em;">
		{% endif %}
		{% if user.is_authenticated and can_vote %}
			{% if link.votes != 'None' %}
				{% for vote in vote_cluster reversed %}
					{% if link.id == vote.link.id %}
						{% if vote.value == -1 %}
							{% if vote.voter.username in checked %}
								<span style="color:red;font-size:80%;"><b><a href="{% url 'profile' slug=vote.voter.username %}">{{ vote.voter.username }}</a><span style="color:deeppink;">*</span></b> ne <b>{{ link.submitter.username }}</b> ko nani yad kara di (-300)!<br></span>
							{% else %}
								<span style="color:red;font-size:80%;"><b><a href="{% url 'profile' slug=vote.voter.username %}">{{ vote.voter.username }}</a></b> ne <b>{{ link.submitter.username }}</b> ko chupair mari<br></span>
							{% endif %}
						{% endif %}
						{% if vote.value == 1 %}
							{% if vote.voter.username in checked %}
								<span style="color:green;font-size:80%;"><b><a href="{% url 'profile' slug=vote.voter.username %}">{{ vote.voter.username }}</a><span style="color:deeppink;">*</span></b> ne <b>{{ link.submitter.username }}</b> ko buhuuut barri jhappee mari (+50)!<br></span>
							{% else %}
								<span style="color:green;font-size:80%;"><b><a href="{% url 'profile' slug=vote.voter.username %}">{{ vote.voter.username }}</a></b> ne <b>{{ link.submitter.username }}</b> ko jhappi mari<br></span>
							{% endif %}
						{% endif %}
					{% endif %}
				{% endfor %}
			{% endif %}
		</p>
		{% endif %}
<p style="color:gray"><hr size=1></p>
{% endfor %}
</div>
</span>


{% endblock %}

{% block pagination %}
{% if is_paginated %}
<div class="pagination">
	{% if page_obj.has_previous %}
    &nbsp;&nbsp;&nbsp;<a href="?page={{ page_obj.previous_page_number }}#section0" style="font-family:arial;"><b style="color:red;text-shadow:0 0 0px red;"><</b><bdi>wapis</bdi></a>
    {% endif %}
    &nbsp;&nbsp;&nbsp;&nbsp;
    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}#section0" style="font-family:arial;"><bdi>aagey</bdi><b style="color:green;text-shadow:0 0 0px green;">></b></a>
    {% endif %}
</div>
{% endif %}
{% endblock %}


