{% extends "base.html" %}
{% load humanize %}
{% load s3 %}
{% load future_time %}
{% load get_voting %}
{% load get_curate_photo %}
{% load emoticons_tags %}
{% block content %}
<div class="margin clb">
{% if error %}

  <b class="cb">{{ slug }}</b> ki profile Damadam ki duniya mein nahi hai {% emoticons %}:({% endemoticons %}<br><br>
  <a href="{% url 'home' %}#section0"><button class="btn bcb bm mbs">wapis</button></a>
  <br><br>

{% else %}

{% if page_obj.number == 1 %}
    {% if not mobile_verified %}
    <div class="cr cl" style="border: 1px dashed #ccc;border-radius:4px;display: inline-block;padding:5px 1em 5px 1em;background-color:#E8E8E8;font-weight:bold;">Ye profile verified nahi hai
    </div>
    {% endif %}
    {% if own_profile %}
                  {% if time_remaining == '-2' %}
                    <h2 class="cg">Tumhari photos:</h2>
                    <span class="cgy">
                    {% if recent_fans > 1 %}
                    <b>{{ recent_fans }} fans</b> pichle 1 day mein<br>
                    {% elif recent_fans == 1 %}
                    <b>{{ recent_fans }} fan</b> pichle 1 day mein<br>
                    {% else %}
                    <b>{{ recent_fans }} fan</b> pichle 1 day mein<br>
                    {% endif %}
                    </span>
                    <a href="{% url 'edit_profile' %}#section0"><button class="btn nw bcg bxl mtl mbl">Profile set kro</button></a>
                    <br>
                    {% if subject.userprofile.avatar %}
                    <b>Profile photo:</b><br>
                    <img class="pht" src="{{ subject.userprofile.avatar|s3 }}" alt="profile photo"></img>
                    {% endif %}
                  {% else %}
                    <span class="cr">
                      {% if time_remaining == '-1' %}
                        {% if own_profile %}
                          <b>BANNED:</b> Tumhari photos <b>hamesha</b> ke liye banned hain
                        {% else %}
                          <b>BANNED:</b> {{ slug }} ki photos <b>hamesha</b> ke liye banned hain
                        {% endif %}
                      {% else %}
                        {% if own_profile %}
                          <b>BANNED:</b> Tumhari photos ka ban khatm ho ga <b>{{ time_remaining|future_time }}</b>
                        {% else %}
                          <b>BANNED:</b> {{ slug }} ki photos ka ban khatm ho ga <b>{{ time_remaining|future_time }}</b>
                        {% endif %}
                      {% endif %}
                      </span>
                  {% endif %}
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Photo score:</b>&nbsp;<span class="cp"><b>{{ subject.userprofile.media_score }}</b></span>
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Nickname:&nbsp;</b><span class="clb">{{ slug }}</span><a href="{% url 'user_profile' slug %}#section0" class="cs">&nbsp;<button class="btn bcg bm mls">profile</button></a>
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Password:&nbsp;</b><a href="{% url 'reauth' %}#section0"><button class="btn bcg bm">badlo</button></a>
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Fans:</b>
                  <a href="{% url 'fan_list' star_id %}#section0" class="cs">
                  <button class="btn bcg">&nbsp;{{ fans }}&nbsp;</button>
                  </a>
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Stars:</b>
                  <a href="{% url 'star_list' %}#section0" class="cs">
                  <button class="btn bcg">&nbsp;{{ stars }}&nbsp;</button>
                  </a>
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Blocked users:</b>
                  <a href="{% url 'banned_users_list' %}#section0" class="cs">
                  <button class="btn bcg">&nbsp;{{ blocked }}&nbsp;</button>
                  </a>
                  <hr size=1 COLOR="#ff9933">
                  <br>
    {% else %}
                  {% if time_remaining == '-2' %}
                    <h2 class="cg">{{ slug }}{% if slug in legit %}<span class="pkstr">*</span>{% endif %} ki photos:</h2>
                    <div class="mbl cgy">
                    {% if recent_fans > 1 %}
                    <b>{{ recent_fans }} fans</b> pichle 1 day mein<br>
                    {% elif recent_fans == 1 %}
                    <b>{{ recent_fans }} fan</b> pichle 1 day mein<br>
                    {% else %}
                    <b>{{ recent_fans }} fan</b> pichle 1 day mein<br>
                    {% endif %}
                    </div>
                      {% if subject.userprofile.avatar %}
                      <b>Profile photo:</b><br>
                      <img class="pht" src="{{ subject.userprofile.avatar|s3 }}" alt="profile photo"></img>  
                      {% endif %}
                    {% else %}
                    <span class="cr">
                      {% if time_remaining == '-1' %}
                        {% if own_profile %}
                          <b>BANNED:</b> Tumhari photos hamesha ke liye banned hain
                        {% else %}
                          <b>BANNED:</b> {{ slug }} ki photos hamesha ke liye banned hain
                        {% endif %}
                      {% else %}
                        {% if own_profile %}
                          <b>BANNED:</b> Tumhari photos ka ban khatm ho ga <b>{{ time_remaining|future_time }}</b>
                        {% else %}
                          <b>BANNED:</b> {{ slug }} ki photos ka ban khatm ho ga <b>{{ time_remaining|future_time }}</b>
                        {% endif %}
                      {% endif %}
                      </span>
                    {% endif %}
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Photo score:</b>&nbsp;<span class="cp"><b>{{ subject.userprofile.media_score }}</b></span>
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Nickname:&nbsp;</b><span class="clb">{{ slug }}</span><a href="{% url 'user_profile' slug %}#section0" class="cs">&nbsp;<button class="btn bcg bm mls">profile</button></a>
                  {% if manageable and user.username == 'pathan-e-khan' %}&nbsp;<form method="POST" action="{% url 'manage_user' %}" style="display:inline">{% csrf_token %}<input type="hidden" name="m_id" value="{{ user.id }}"><input type="hidden" name="t_id" value="{{ star_id }}"><button type="submit" class="btn bco bm mls">manage</button></form>{% endif %}
                  <hr size=1 COLOR="#b3e6b3">
                  <b>Fans:</b>
                  <a href="{% url 'fan_list' star_id %}" class="cs"><button class="btn bcg mrl mbs">&nbsp;{{ fans }}&nbsp;</button></a>
                   {% if authenticated and not own_profile and allowed_fan %}
                    <form action="{% url 'fan' %}" method="POST" style="display:inline">
                    {% csrf_token %}
                    <input type="hidden" name="oid" value="0">
                    <input type="hidden" name="org" value="1">
                      {% if not_fan %}
                      <button type="submit" name="sid_btn" class="btn nw bcg bxl" value="{{ subject_id }}">iske fan bano</button>
                      {% else %}
                      <button type="submit" name="sid_btn" class="btn nw bcr bxl" value="{{ subject_id }}">fan khatm kro</button>
                      {% endif %}
                    </form>
                    {% endif %}
                  <hr size=1 COLOR="#ff9933">
                  <br>
    {% endif %}
  {% endif %}

{% for photo in object_list %}
  
                          <a name="sectionJ">
                          <a name="section{{ forloop.counter }}"></a>
                          <a href="{% url 'comment_pk' photo.id 3 star_id %}">
                          <button class="btn nw bl mts mbl mrl" style="color:#ff8000;background-color:#F8F8F8;border-color:#B8B8B8;">
                          {% if photo.comment_count == 0 %}
                          tabsra kro
                          {% elif photo.comment_count == 1 %}
                          <b>1</b> tabsra
                          {% else %}
                          <b>{{ photo.comment_count }}</b> tabsrey
                          {% endif %}
                          </button>
                          </a>

                          {% if not own_profile %}
                            {% if time_remaining == '-2' or defender %}

                            <div style="display:inline-block">
                            {% curate_photo pid=photo.id vsc=photo.vote_score oun=subject.username caption=photo.caption oid=star_id purl=photo.image_file|s3:'thumb' origin=4 static_url=STATIC_URL %}
                            </div>

                            {% endif %}
                          {% endif %}
                          <br>

                          <b class="cb cl"><bdi>{% emoticons %}{{ photo.caption }}{% endemoticons %}</bdi></b><span class="cxs cgy">, {{ photo.upload_time|naturaltime }}</span><br>

                          {% if time_remaining == '-2' %}
                          <img class="iw ibg" src="{{ photo.image_file|s3 }}" alt="{{ photo.caption }}"></img>
                          {% else %}  
                          <img class="iw ibg" src="{{ photo.image_file|s3:'thumb' }}" alt="{{ photo.caption }}"></img>
                          {% endif %}
                          <br>
                          


                          {% if not own_profile and can_vote and photo.id not in voted and time_remaining == '-2' %}
                            {% vote_buttons vote_type='photo_vote' pid=photo.id origin=4 oun=subject.username static_url=STATIC_URL %}
                          {% endif %}


                                <a href="{% url 'photo_izzat' photo.id 3 slug %}">
                                {% if photo.visible_score > 1 %}
                                <button class="btn nw bl mtl mbs" style="color:#00C853;background-color:#F8F8F8;border-color:#B8B8B8;"><b>{{ photo.visible_score }}</b> points</button>
                                {% elif photo.visible_score == 1 %}
                                <button class="btn nw bl mtl mbs" style="color:#00C853;background-color:#F8F8F8;border-color:#B8B8B8;"><b>{{ photo.visible_score }}</b> point</button>
                                {% else %}
                                <button class="btn nw bl mtl mbs" style="color:#F44336;background-color:#F8F8F8;border-color:#B8B8B8;"><b>{{ photo.visible_score }}</b> points</button>
                                {% endif %}
                                </a>
                        
                                <br>


                                <a href="{% url 'photo_share' photo.id 3 photo.owner.username %}"><button class="btn nw bcp mts" style="width:12em;">photo share kro</button></a>
                          
                          <br>
                          <p><hr size=1 COLOR="#BDBDBD"></p>                        
{% empty %}
  {% if own_profile %}
  <span class="cgy">Damadam pe&nbsp;<a href="{% url 'upload_public_photo' %}#section0"><button class="btn nw bco mts" style="width:11em;">photos charhao</button></a></span>
  {% else %}
  <span class="cgy">{{ slug }} ne photos nahi lagain, kisi aur ki&nbsp;<a href="{% url 'best_photo' %}#section0"><button class="btn nw bco bxl mts">photos dekho</button></a></span>
  {% endif %}
{% endfor %}
{% endif %}
</div>
{% endblock %}

{% block pagination %}
{% if is_paginated %}
<div class="pagination" style="text-align: center;">
  {% if page_obj.has_previous %}
    &nbsp;&nbsp;&nbsp;<a href="?page={{ page_obj.previous_page_number }}#sectionJ"><button class="btn bcr bm"><bdi>wapis</bdi></button></a>
    {% endif %}
    &nbsp;&nbsp;&nbsp;&nbsp;
    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}#sectionJ"><button class="btn bcg bm"><bdi>aagey</bdi></button></a>
    {% endif %}
</div>
{% endif %}
<br><br>
{% endblock %}